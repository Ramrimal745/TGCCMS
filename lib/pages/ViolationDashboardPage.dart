import 'package:flutter/material.dart';import 'package:get/get.dart';import 'package:tcs_demo/requestModels/ReportRequest.dart';import 'package:tcs_demo/responseModels/ReportResponse.dart';import 'package:tcs_demo/utils/PreferenceManager.dart';import 'package:tcs_demo/viewModels/ReportViewModel.dart';class ViolationDashboardPage extends StatefulWidget {  final WingDashboardCount wingData;  final String requestFlag;  const ViolationDashboardPage({    super.key,    required this.wingData,    required this.requestFlag,  });  @override  State<ViolationDashboardPage> createState() => _ViolationDashboardPageState();}class _ViolationDashboardPageState extends State<ViolationDashboardPage> {  final preferenceManager = Get.put(PreferenceManager());  final reportViewModel = Get.put(ReportViewModel());  void fetchViolations() async {    final loginId = await preferenceManager.getValue(preferenceManager.loginId);    reportViewModel.fetchViolationWiseCount(        ReportRequest(          loginId: loginId,          wingId: widget.wingData.wingId ?? "",          requestFlag: widget.requestFlag,        )    );  }  @override  void initState() {    super.initState();    fetchViolations();  }  @override  Widget build(BuildContext context) {    return Scaffold(      resizeToAvoidBottomInset: false,      appBar: AppBar(        backgroundColor: Colors.blueAccent,        title: const Text(          'Violation Wise Report',          style: TextStyle(              color: Colors.white, fontWeight: FontWeight.w600, fontSize: 16),        ),        leading: IconButton(          icon: const Icon(Icons.arrow_back, color: Colors.white),          onPressed: () {            Navigator.pop(context);          },        ),      ),      body: Obx(            () => SingleChildScrollView(          padding: const EdgeInsets.all(12),          child: Column(            children: [              Container(                decoration: BoxDecoration(                    color: Colors.blue,                    borderRadius: BorderRadius.circular(8)),                child: Column(                  children: [                    const SizedBox(height: 10),                    Text(                      widget.wingData.wingName ?? "",                      style: const TextStyle(                          color: Colors.white,                          fontWeight: FontWeight.w600,                          fontSize: 14),                    ),                    reportViewModel.violationWiseCountState.value                        .whenOrNull(loading: () => true) == true                        ? const Padding(                      padding: EdgeInsets.all(8.0),                      child: Align(                        alignment: Alignment.center,                        child: CircularProgressIndicator(color: Colors.white),                      ),                    )                        : Container(                      margin: const EdgeInsets.all(4),                      color: Colors.white,                      child: ListView.builder(                        physics: const NeverScrollableScrollPhysics(),                        shrinkWrap: true,                        itemCount: reportViewModel.violationWiseCountState.value                            .whenOrNull(success: (data) => data as ViolationDashboardResponse?)                            ?.violationDashboardCount                            ?.length ??                            0,                        itemBuilder: (context, index) {                          final item = reportViewModel.violationWiseCountState.value                              .whenOrNull(success: (data) => data as ViolationDashboardResponse?)                              ?.violationDashboardCount?[index];                          return Column(                            mainAxisSize: MainAxisSize.max,                            mainAxisAlignment: MainAxisAlignment.start,                            children: [                              Padding(                                padding: const EdgeInsets.all(10.0),                                child: Column(                                  crossAxisAlignment: CrossAxisAlignment.start,                                  children: [                                    SizedBox(                                      width: double.infinity,                                      child: Text(                                        item?.violationName ?? "",                                        style: const TextStyle(                                            fontWeight: FontWeight.bold, fontSize: 14),                                      ),                                    ),                                    const SizedBox(height: 8),                                    Text(                                      "Challan Count: ${item?.totalChallans ?? ""}",                                      style: const TextStyle(                                          fontWeight: FontWeight.w600, fontSize: 12),                                    ),                                    const SizedBox(height: 8),                                    Text(                                      "Penality Amount: ${item?.totalAmount ?? ""}",                                      style: const TextStyle(                                          fontWeight: FontWeight.w600, fontSize: 12),                                    ),                                  ],                                ),                              ),                              Container(height: 1, width: double.infinity, color: Colors.black54)                            ],                          );                        },                      ),                    )                  ],                ),              )            ],          ),        ),      ),    );  }}